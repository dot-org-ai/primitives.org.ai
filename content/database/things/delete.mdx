---
title: Delete
description: Deleting entities
---

# Delete

Remove entities with `delete`.

## Basic Delete

```typescript
const success = await db.Post.delete('hello-world')
// Returns true if deleted, false if not found
```

## Delete by URL

```typescript
await db.delete('https://example.com/posts/hello-world')
await db.delete('posts/hello-world')
```

## Batch Delete

```typescript
const ids = ['post-1', 'post-2', 'post-3']

await Promise.all(
  ids.map(id => db.Post.delete(id))
)
```

## Conditional Delete

```typescript
// Delete all drafts older than 30 days
const oldDrafts = await db.Post.find({
  status: 'draft',
  createdAt: { $lt: thirtyDaysAgo },
})

for (const draft of oldDrafts) {
  await db.Post.delete(draft.$id)
}
```

Or with forEach:

```typescript
await db.Post.forEach(
  { where: { status: 'draft', createdAt: { $lt: thirtyDaysAgo } } },
  async (draft) => {
    await db.Post.delete(draft.$id)
  }
)
```

## Events

Delete emits a `{Type}.deleted` event:

```typescript
await db.Post.delete('hello')
// Emits: Post.deleted { url, timestamp }

db.events.on('Post.deleted', async (event) => {
  console.log(`Deleted: ${event.url}`)
})
```

## Cascade Behavior

By default, deleting an entity:
- Removes all relationships to/from it
- Invalidates all artifacts

```typescript
// Delete author
await db.Author.delete('alice')

// Posts still exist but author relationship is null
const post = await db.Post.get('hello')
post.author  // null
```

## Soft Delete

Implement soft delete with a status field:

```typescript
const db = DB({
  Post: {
    title: 'string',
    deletedAt: 'datetime?',
  }
})

// Soft delete
await db.Post.update('hello', {
  deletedAt: new Date(),
})

// Query non-deleted
const posts = await db.Post.find({
  deletedAt: { $exists: false },
})
```

## Artifacts

Deleting an entity removes its artifacts:

```typescript
await db.Post.delete('hello')

// Artifacts are gone
const embedding = await db.artifact.get('hello', 'embedding')
// null
```

## Return Value

```typescript
const deleted = await db.Post.delete('hello')

if (deleted) {
  console.log('Post deleted')
} else {
  console.log('Post not found')
}
```

## Undo Delete

Delete is permanent. For undo support, use soft delete or events:

```typescript
// Subscribe to deletions for audit log
db.events.on('*.deleted', async (event) => {
  await auditLog.create({
    action: 'delete',
    entity: event.url,
    timestamp: event.timestamp,
  })
})
```
